/*|1.93.2.95-S-95|publish|2022-06-14T14:48:16.765Z|*/
!function(t){t.version=t.version||"1.93.2.95-S-95",t.time=t.time||new Date(1655218096765)}(window["~hpe~"]||(window["~hpe~"]={})),(window["~hpeWpJsonp~"]=window["~hpeWpJsonp~"]||[]).push([[117],{"hpe-my-account/modal-signinup-overlay":function(t,e,o){"use strict";o.r(e);var n,r,i=o("core/view"),s=o("core/helpers/promise-utils"),c=o("core/helpers/config"),a=o(0),p=o(2),u=o("core/spinner"),l=o("core/helpers/component"),f=o("hpe-my-account/modal-signinup-signin"),h=o("hpe-my-account/modal-signinup-signup"),d=o("core/helpers/browser"),m=o("hpe-forms/hpe-form-item"),y=o("hpe-forms/hpe-form-wrapper"),b=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),o=function(t,e,o,n){var r,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;0<=c;c--)(r=t[c])&&(s=(i<3?r(s):3<i?r(e,o,s):r(e,o))||s);return 3<i&&s&&Object.defineProperty(e,o,s),s},p=(r=i.default,b(g,r),Object.defineProperty(g.prototype,"contentURL",{get:function(){return Object(c.getConfig)("myAccount.modalSignIn")},enumerable:!1,configurable:!0}),g.prototype.init=function(){m.HPEFormItem.register(),y.HPEFormWrapper.register(),document.addEventListener("modal-signinup:open",this.openModal)},g.prototype.onDestroy=function(){document.removeEventListener("modal-signinup:open",this.openModal)},g.prototype.openModal=function(t){var e=this;t.preventDefault(),t.stopPropagation(),this.loadModal().then(function(){return e.$el.modal()})},g.prototype.loadModal=function(){var e=this;return u.default.show(),fetch(this.contentURL).then(s.default.fetchText).then(function(t){e.$el.html(t),d.isIE&&e.$el.find("style").append(" "),Object(l.initComponent)(f.a,e.find(".sign-in-links")),Object(l.initComponent)(h.a,e.find(".sign-up")),u.default.hide()})},o([a.a],g.prototype,"openModal",null),o([Object(p.a)()],g.prototype,"loadModal",null),g);function g(){return null!==r&&r.apply(this,arguments)||this}e.default=p},"hpe-my-account/modal-signinup-signin":function(t,e,o){"use strict";var n,r,i=o("core/view"),s=o("styleguide/arrow-link"),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),o=(r=i.default,o(c,r),c.prototype.init=function(){this.processLink()},c.prototype.processLink=function(){this.find(".hpe-arrow-link").each(function(t,e){return Object(s.processArrowLink)(e)}),this.find(".js-redirect-resource-parameter a").each(function(t,e){var o=new URL(e.href);o.searchParams.set("resource",window.location.pathname),e.href=o.toString()})},c);function c(){return null!==r&&r.apply(this,arguments)||this}e.a=o},"hpe-my-account/modal-signinup-signup":function(t,e,o){"use strict";var n,r,i=o("core/log"),s=o("core/view"),c=o("core/helpers/dom"),a=o(0),p=o(2),u=o("core/helpers/config"),l=o("core/helpers/scroll"),f=o("core/helpers/auth-api"),h=o("core/helpers/metrics-my-account"),d=o("cockpit/api/shared"),m=o("demandgen/utils/checkboxes-preselection"),y=o("hpe-my-account/account-creation-v2"),b=o("hpe-my-account/init-service"),g=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),O=function(){return(O=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var r in e=arguments[o])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},o=function(t,e,o,n){var r,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;0<=c;c--)(r=t[c])&&(s=(i<3?r(s):3<i?r(e,o,s):r(e,o))||s);return 3<i&&s&&Object.defineProperty(e,o,s),s},S="MODAL_SIGN_IN/UP",a=(r=s.default,g(_,r),_.prototype.init=function(){var e=this;this._apiReady=d.SharedAPI.cockpit$.then(function(t){return e._api=t}),this.checkboxesPreselection=new m.CheckboxesPreselection({form:this.$form,checkboxesSelector:"input[type='checkbox']",countryFieldSelector:"select[name='".concat(y.COUNTRY_FIELD_NAME,"']")}),this.toFormState()},Object.defineProperty(_.prototype,"thirdPartyService",{get:function(){return Object(b.a)(this.options.thirdPartyService,{formName:this.options.thirdPartyServiceFormId})},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"$formState",{get:function(){return this.find(this.options.formState)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"$submitState",{get:function(){return this.find(this.options.submitState)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"$blockedState",{get:function(){return this.find(this.options.blockedState)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"$form",{get:function(){return Object(c.unwrap)(this.find(this.options.form))},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"preferredLanguage",{get:function(){var t=Object(u.getConfig)("i18n.lc");return"ar"===t?"en":t},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"acceptanceNotification",{get:function(){return this.find(this.options.acceptanceNotification)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"submitNotification",{get:function(){return this.find(this.options.submitNotification)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"$submit",{get:function(){return $(this.$form).find(this.options.submit)},enumerable:!1,configurable:!0}),_.prototype["{form} input,select,button[type='submit'] on:focus click"]=function(){this._onCreateAccountStart()},_.prototype["{form} on:hpe:form:submit"]=function(){this._submitForm()},_.prototype["{body} .modal on:shown.bs.modal"]=function(){this.toFormState(),h.MetricsMyAccount.fireCreateAccountStartEvent()},_.prototype._prepareData=function(t){var e=this.$form.serialize();return"passport"===t&&this.options.skipFieldsInPassportSubmit.forEach(function(t){delete e[t]}),"marketo"===t&&Object.keys(e).forEach(function(t){""===e[t]&&delete e[t]}),O(O({},e),{preferredLanguage:this.preferredLanguage})},_.prototype._onCreateAccountStart=function(){h.MetricsMyAccount.trackCreateAccountStart(h.MetricsMyAccount.getParentPageFromCurrent)},_.prototype._submitForm=function(){var e=this;this._hideNotify(),this._showSpinner();var t=this._prepareData("passport");this._apiReady.then(function(){return e._checkUserExist(t)}).then(function(){return e.thirdPartyService.submitData(e._prepareData(e.options.thirdPartyService))}).then(function(){return e._createAccount(t)}).catch(function(t){t&&(Object(i.error)(t),"RplCheckFailedException"===t.code?e.toBlockedState():e._showSubmitNotify(e.options.errMsg)),e._hideSpinner()})},_.prototype._checkUserExist=function(t){var e=this;return this._api.auth.isUserExist(t.emailAddress).catch(function(){return Promise.resolve({})}).then(function(t){return!t.status||t.providers&&-1===t.providers.indexOf("passport")?Promise.resolve():(Object(i.debug)("".concat(S,": checkUser response"),t),e._showSubmitNotify(e.options.emailExistsErrMsg),Promise.reject())})},_.prototype._createAccount=function(e){var o=this;return this._api.auth.createAccount("passport",e).then(function(t){if(t.exception)o._showSubmitNotify(f.AUTH_API_ERROR_PROCESSOR.getExceptionMsg(t));else if(Object(i.debug)("".concat(S,": create account response"),t),o._isValidCreateAccountResponse(t,e)){o.toSubmitState(),h.MetricsMyAccount.fireCreateAccountCompleteEvent(t.emailAddress);try{h.MetricsMyAccount.trackCreateAccountComplete(h.MetricsMyAccount.getParentPageFromCurrent,t.emailAddress)}catch(t){Object(i.debug)("".concat(S,": metric error: "),t)}o.$form.reset(),o._hideSpinner()}else o.toErrorState()})},_.prototype.toFormState=function(){this.$formState.removeClass(this.options.hiddenClass),this.$submitState.addClass(this.options.hiddenClass),this.$blockedState.addClass(this.options.hiddenClass)},_.prototype.toErrorState=function(){this._showSubmitNotify(this.options.errMsg),Object(i.error)("Invalid create account response"),this._hideSpinner()},_.prototype.toSubmitState=function(){this.$formState.addClass(this.options.hiddenClass),this.$submitState.removeClass(this.options.hiddenClass),Object(l.scrollToTop)()},_.prototype.toBlockedState=function(){this.$formState.addClass(this.options.hiddenClass),this.$blockedState.removeClass(this.options.hiddenClass),Object(l.scrollToTop)()},_.prototype._showSpinner=function(){this.$submit.addClass(this.options.spinnerClass)},_.prototype._hideSpinner=function(){this.$submit.removeClass(this.options.spinnerClass)},_.prototype._hideNotify=function(){this.submitNotification.removeClass(this.options.showNotificationClass)},_.prototype._showSubmitNotify=function(t){this.submitNotification.text(t),this.submitNotification.addClass(this.options.showNotificationClass)},_.prototype.onDestroy=function(){this.checkboxesPreselection.unbindEvents(),r.prototype.onDestroy.call(this)},_.prototype._isValidCreateAccountResponse=function(t,e){return t.userId&&t.emailAddress&&t.userId===t.emailAddress&&t.emailAddress===e.emailAddress},_.defaults={formState:".sign-up-form-state",submitState:".sign-up-submit-state",blockedState:".sign-up-blocked-state",form:".js-signinup-up-form-wrapper",submitNotification:".js-submit-notification",submit:".submit-btn",showNotificationClass:"visible",hiddenClass:"hidden",spinnerClass:"spinner-shown",skipFieldsInPassportSubmit:["emailOptIn","phoneOptIn"]},o([Object(p.a)()],_.prototype,"thirdPartyService",null),o([Object(p.a)()],_.prototype,"$formState",null),o([Object(p.a)()],_.prototype,"$submitState",null),o([Object(p.a)()],_.prototype,"$blockedState",null),o([Object(p.a)()],_.prototype,"$form",null),o([Object(p.a)()],_.prototype,"preferredLanguage",null),o([Object(p.a)()],_.prototype,"acceptanceNotification",null),o([Object(p.a)()],_.prototype,"submitNotification",null),o([Object(p.a)()],_.prototype,"$submit",null),o([Object(p.a)()],_.prototype,"_onCreateAccountStart",null),o([a.a],_.prototype,"toErrorState",null),_);function _(){return null!==r&&r.apply(this,arguments)||this}e.a=a}}]);