!(function(){var dtmRoutine;(function(routine){var data={"resources":{"vtUrl":"https://developer.huawei.com/consumer/cn/service/josp/agc/WiseCloudDTMPortal/","id":"DTM-0a04ab067c9c1887817cff2a2249408f"}};var I=function(){var e=data&&data.resources&&data.resources.id||"";return{getDtmLogId:function(){return e},warn:function(){var e=Array.prototype.slice.call(arguments).join("");e.length},error:function(){var e=Array.prototype.slice.call(arguments).join("");e.length}}}();var a=null;function o(e,t,r){var n=document.createElement("script");n.type="text/javascript";n.async=!0;n.src=e;t&&(n.addEventListener?n.onload=t:n.onreadystatechange=function(){n.readyState in{loaded:!0,complete:!0}&&(n.onreadystatechange=null,t())});r&&(n.onerror=r);if(null===a){r=window.document.querySelector&&window.document.querySelector("script[nonce]");a="";if(r){var i=r.nonce||r.getAttribute("nonce");i&&/^[\w+/_-]+[=]{0,2}$/.test(i)&&(a=i)}}a&&n.setAttribute("nonce",a);i=document.getElementsByTagName("script")[0]||document.body||document.head;i.parentNode.insertBefore(n,i)}function s(){return data&&data.resources&&data.resources.vtUrl||""}function e(){I.warn("[TAG] window property is overridden")}var t="function"==typeof window.addEventListener?window.addEventListener:e;var r=window.parent&&window.parent.postMessage&&"function"==typeof window.parent.postMessage?window.parent:{postMessage:e};var n=window.opener&&window.opener.postMessage&&"function"==typeof window.opener.postMessage?window.opener:{postMessage:e};var i={inquiry:function(){t("message",this._callback,!1);try{r.postMessage({type:"notify",code:"inIframe",options:{url:window.location.href,id:data&&data.resources&&data.resources.id||""}},"*")}catch(e){}},_makeValidUrl:function(e,t){var r="dist/static/vt/dtm-vt.js";var n={code:0,url:""};var i=document.getElementsByTagName("script");for(var a=0;a<i.length;a++)if(-1!==i[a].src.indexOf(r)){n.code=-1;return n}if(e.publicId&&u!==e.publicId){n.code=-2;return n}if(!e.vtHost){n.code=-3;return n}if(-1===t.indexOf(e.vtHost)){n.code=-4;return n}e=String.prototype.charAt.call(t,t.length-1);e=-1===e.indexOf("/")?"/":"";n.url=t+e+r;return n},_callback:function(e){var t=e.data;if("iFrameOk"===t.status){e=s();e="string"==typeof e?e:"";e=i._makeValidUrl(t,e);0===e.code?o(e.url,function(){try{r.postMessage({type:"notify",code:"vtLoaded",options:{url:window.location.href}},"*")}catch(e){}},function(){I.warn("[TAG] failed to load dtm vt js.")}):I.warn("[TAG] dtm vt url is wrong with "+e.code)}}};t("load",function(e){i.inquiry()},!0);var c=function(e){var t=e.split("://");e="http"===t[0].toLowerCase()?"http://":"https://";t=t[1].split("/");t=t[0];t=e+t;return t}(s());var u=data&&data.resources&&data.resources.id||"";function l(e){this.code=String(e.code)||"pulse";e.extra&&(this.extra=e.extra);this.feedbackCB="function"==typeof e.feedBackCallback?e.feedBackCallback:function(e){};this.errorCB="function"==typeof e.errorCallback?e.errorCallback:function(e){};this.timeOut=Number(e.timeOut)||0}l.prototype.sendMessage=function(){try{var e=String(Math.random());var t={type:"r",code:this.code,ver:p.dtm_version,hash:e};this.extra&&(t.extra=this.extra);p.dtm_ext_enable?window.postMessage({code:"dtm-packet-to-portal",packet:t},window.location.origin):n.postMessage(t,c);return e}catch(e){return""}};var d=function(){var s=["dtm_version","dtm_digest","dtm_id","dtm_debug","dtm_lang","dtm_portal_ver","dtm_t","workspaceId"];var c=[!0,!0,!0,!1,!1,!1,!1,!1];function t(e){return Array.prototype.indexOf.call(s,e)}return{checkIfParamLegal:function(e){return 0<=t(e)},checkIfParamMandatory:function(e){e=t(e);return 0<=e&&!!c[e]},getQueryKeyList:function(){return s},justifyParams:function(e){var t;if(e.dtm_id&&e.dtm_id!==u)t="dtmMismatch";else{var r=[];for(var n=0;n<s.length;n++){var i=s[n];e[i]?r.push(c[n]):r.push(!1)}var a=r.join();var o=c.join();a===o?t="ok":0<=a.indexOf("true")&&(t="dtmParamMissing")}return t}}}();var f=function(){var e=["dtm_version","dtm_digest","dtm_debug","workspaceId"];return{getJsQueryKeyList:function(){return e}}}();var p=function(){var r=window.location.search;if(window[u])I.warn("[bootloader] preview "+u+" is duplicated!");else{var e=function(){var t={};if("?"===r[0]){r=r.substring(1);var e=r.split("&");Array.prototype.forEach.call(e,function(e){e=e.split("=");d.checkIfParamLegal(e[0])&&(t[e[0]]=e[1])})}return t}();if(!e.dtm_t){"{}"===JSON.stringify(e)&&(e=n()||{});var t=d.justifyParams(e);t&&(e.dtm_preview_err=t);return e}!function(){var e=window.location.search;e=e.replace(/(&|\?)dtm_t=([0-9]+)/,"");"&"===e[0]&&(e=e.slice(1));e&&"?"!==e[0]&&(e="?"+e);e=window.location.origin+window.location.pathname+e+window.location.hash;window.location.replace(e)}()}function n(){var e=document.getElementsByTagName("head")[0];var t=e.getElementsByTagName("script");var r;for(var n=0;n<t.length;n++){var i=t[n];if(i.src&&-1!==i.src.indexOf("dtm.js?id=")){r=function(r){var n={};Array.prototype.forEach.call(d.getQueryKeyList(),function(e){var t=r.getAttribute(e);t&&(n[e]=t)});return n}(i);if(r.dtm_id===u){r.dtm_ext_enable=!0;break}}}return r}}();var v=function(){};routine&&void 0===routine.name&&(routine.name="dtmRoutine");v="function"==typeof routine&&"dtmRoutine"===routine.name?routine:v;function m(e){I.warn("[bootloader]","Error: failed to load preview: "+e);e=p.dtm_id||u;e=window[e]&&window[e].ballonTip;e&&"function"==typeof e.turnOff&&e.turnOff()}function g(e,t,r){var n=s();var i=String.prototype.charAt.call(n,n.length-1);i=-1===i.indexOf("/")?"/":"";n=n+i+"dist/static/pv/dtm-pv.js#id="+e;o(n,t,r)}if(p&&"ok"===p.dtm_preview_err){!function(){p.dtmLog=I;window[p.dtm_id]=p;p.dtmDebugReqQ={_requestQueue:{},_add:function(e,t){this._requestQueue[e]=t},_remove:function(e){if(this._requestQueue[e]){delete this._requestQueue[e];return!0}return!1},triggerRequest:function(e){var t=new l(e);var r=t.sendMessage();if(r){this._add(r,t);var n=this;t.timeOut&&setTimeout(function(){n._remove(r)&&t.errorCB("postMessage timeout")},t.timeOut)}else t.errorCB("postMessage exception")},feedBackHandle:function(e){var t=e.hash;var r=this._requestQueue[t];if(r){this._remove(t);r.code===e.code?r.feedbackCB(e):r.errorCB("feedback code:"+e.code+" is mismatched with "+r.code)}else e.code}};Object.defineProperty(window,p.dtm_id,{configurable:!1,writable:!1});Object.freeze(p.dtmDebugReqQ);t("message",function(e){"f"===e.data.type?p.dtmDebugReqQ.feedBackHandle(e.data):e.data.code},!1)}();var h=function(e){for(var t=0;t<e.length;t++)if(-1!==e[t].src.indexOf("dtm.js?id=")&&0<=e[t].src.indexOf(u))return e[t].src;return""}(document.getElementsByTagName("script"));var w=function(e){var t=function(e){var t=e.split("#");e=[];e.push(t[0].slice());t[0]="";e.push(t.join("#"));return e}(e);var r=t[0].split("&");if(-1!==r[0].indexOf("dtm.js")){Array.prototype.forEach.call(f.getJsQueryKeyList(),function(e){p[e]&&r.push(e+"="+p[e])});e=r.join("&")+t[1];e=e.replace("/download/","/preview/");o(e,function(){},function(){m("missingVersion");p.dtmDebugReqQ.triggerRequest({code:"err",extra:{errInfo:"missing"},timeOut:1e3});v(I)})}else{m("noDtmJs");v(I)}};g(p.dtm_id,function(){w(h)},function(){m("missingDtmPv");p.dtmDebugReqQ.triggerRequest({code:"err",extra:{errInfo:"missing"},timeOut:1e3});w(h)})}else if(p){var _=p.dtm_preview_err;_&&"ok"!==_&&m(_);v(I)}})(dtmRoutine);})();